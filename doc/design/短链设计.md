# 短链设计



问题

1. URL超长问题   
2. 短链生成算法 -> 发号 -> <短链ID, URL>
3. 读写压力问题



## ID生成算法

|      | hash算法                                                     | 自增序列               |                                                              |                                                              |
| ---- | ------------------------------------------------------------ | ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 实现 | md5、sha、MurmurHash                                         | Redis计数器            | Snowflake                                                    | Redis + MySQL(segment)                                       |
| 优势 | 分布式、可拓展性好                                           | 性能好、id呈趋势递增   | 高性能，去中心化，不依赖DB，单实例故障不影响整体<br>高可读，生成的ID含有时间戳等信息<br>存储少，int64类型存储 | 高性能，ID呈趋势递增                                         |
| 问题 | ID无序，数据库索引插入性能低<br>数据量很大的情况下，冲突概率会增大 | 单点服务<br>扩展性较弱 | 时钟回拨问题                                                 | 单主服务<br>db异常，segment的号段小号完毕，会出现短暂服务不可用 |

